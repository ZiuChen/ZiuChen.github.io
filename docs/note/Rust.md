# Rust

## Rust ç¯å¢ƒæ­å»º

`rustup` æ˜¯ä¸€ä¸ªç”¨äºç®¡ç† Rust ç‰ˆæœ¬å’Œç›¸å…³å·¥å…·çš„å‘½ä»¤è¡Œå·¥å…·ã€‚

Unix ç³»ç»Ÿ:

```sh
$ curl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh
```

Windows ç³»ç»Ÿ:

ä¸‹è½½å¹¶å®‰è£… [rustup-init.exe](https://static.rust-lang.org/rustup/dist/i686-pc-windows-gnu/rustup-init.exe).

å®‰è£…å®Œæ¯•åï¼Œåœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼š

```sh
rustc --version
```

å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„ç‰ˆæœ¬å·ä¿¡æ¯ï¼Œåˆ™ rust å·²å®‰è£…å®Œæ¯•ã€‚

## Hello, Rust!

```sh
mkdir hello_rust
```

åˆ›å»ºå¹¶ç¼–è¾‘ç¬¬ä¸€ä¸ª Rust ç¨‹åºï¼š

```rs
// main.rs
fn main() {
    println!("Hello, Rust!");
}
```

æ‰§è¡Œ `rustc ./hello_rust/main.rs`

å¯ä»¥çœ‹åˆ°åœ¨ä»£ç åŒç›®å½•ä¸‹è¾“å‡ºäº†äºŒè¿›åˆ¶æ–‡ä»¶ `main`ï¼Œåœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œï¼š

```sh
./main
```

å¯ä»¥çœ‹åˆ°è¾“å‡ºï¼š

```sh
> Hello, Rust!
```

ä¸‹é¢æˆ‘ä»¬åˆ†æä¸€ä¸‹è¿™ä¸ªç¨‹åºï¼š

åœ¨ Rust ä¸­ï¼Œå‡½æ•°åä¸º `main` çš„å‡½æ•°æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œå®ƒæ€»æ˜¯ä¼šè¢«æœ€å…ˆæ‰§è¡Œï¼š

```rs
fn main() {

}
```

åœ¨å‡½æ•°ä½“ä¸­çš„ä»£ç ï¼š

```rs
    println!("Hello, Rust!")
```

`println!` æ˜¯ä¸€ä¸ª Rust å®ï¼ˆmacroï¼‰ï¼Œå®ƒä¸å‡½æ•°è°ƒç”¨çš„åŒºåˆ«æ˜¯å®ƒä»¥ `!` ç»“å°¾ã€‚

`"Hello, Rust!"` æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¼ é€’ç»™äº† `println!` å®ã€‚

**Rust ç¨‹åºçš„ç¼–è¯‘å’Œè¿è¡Œæ˜¯ç‹¬ç«‹è¿›è¡Œçš„ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥å°†ç¼–è¯‘äº§ç‰©ç›´æ¥å‘é€ç»™åˆ«äººï¼Œåˆ«äººä¸éœ€è¦å®‰è£… Rust ä¹Ÿå¯ä»¥è¿è¡Œ**

è¿™ä¸ Ruby Python JavaScript è¿™ç±»åŠ¨æ€è¯­è¨€ä¸åŒï¼ŒRust æ˜¯ä¸€é—¨**é¢„ç¼–è¯‘é™æ€è¯­è¨€**ï¼ˆahead-of-time compiledï¼‰

ç®€å•é¡¹ç›®å¯ä»¥ä½¿ç”¨ rustcï¼Œä½†éšç€é¡¹ç›®å¤æ‚åº¦å¢é•¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ cargo æ¥ç®¡ç†é¡¹ç›®ä¸­çš„ä¸‰æ–¹ä¾èµ–ã€ç®¡ç†çœŸå®ä¸–ç•Œä¸­ Rust ç¨‹åºå¼€å‘çš„æ–¹æ–¹é¢é¢ã€‚

## Cargo

```sh
# åˆå§‹åŒ–ä¸€ä¸ª Cargo é¡¹ç›®
cargo new hello_cargo
```

æ‰§è¡Œ `cargo new` åä¼šè‡ªåŠ¨å¸®ä½ åˆå§‹åŒ–ä¸€ä¸ª Git ä»“åº“ï¼Œå¦‚æœä½ æ˜¯åœ¨ä¸€ä¸ªç°å­˜çš„ Git ä»“åº“ä¸­æ‰§è¡Œçš„åˆå§‹åŒ–ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæ‰§è¡Œæ­¤æ“ä½œã€‚

é™¤äº†å¸®ä½ åˆ›å»ºäº†ä¸€ä¸ª HelloWorld ä»£ç ï¼Œ`cargo` è¿˜åˆ›å»ºäº†ä¸€ä¸ª `cargo.toml` æ–‡ä»¶ï¼š

```toml
[package]
name = "hello_cargo"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
```

`[package]`ã€`[dependencies]` åˆ†åˆ«ä»£è¡¨æ˜¯ä¸€ä¸ªç‰‡æ®µï¼š

- å…¶ä¸­ `[package]` ä¸‹çš„å­—æ®µ `name`ã€`version` å’Œ `edition` è¡¨ç¤ºé¡¹ç›®çš„åç§°ã€é¡¹ç›®çš„ç‰ˆæœ¬å’Œä½¿ç”¨çš„ Rust ç‰ˆæœ¬ã€‚
- `[dependenciese]` ä¸­è®°å½•ç€é¡¹ç›®çš„ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œè¿™äº›ä¾èµ–è¢«ç§°ä¸º *crates*

Cargo æœŸæœ›æ‰€æœ‰çš„æºä»£ç éƒ½å­˜æ”¾åœ¨ `src/` ç›®å½•ä¸‹ï¼Œé¡¹ç›®æ ¹ç›®å½•ä¸­ä¿å­˜å¦‚ READMEã€LICENSE è¿™ç±»çš„æ–‡ä»¶ã€‚

### åœ¨ Cargo ä¸­æ„å»ºå’Œè¿è¡Œé¡¹ç›®

æ‰§è¡Œ `cargo build` å¯ä»¥æ„å»ºé¡¹ç›®ï¼š

```sh
cargo build
```

æ„å»ºäº§ç‰©å°†è¾“å‡ºåœ¨ `target/debug/` ç›®å½•ä¸‹ï¼Œè¿™æ˜¯å› ä¸º `cargo build` æ˜¯è°ƒè¯•æ„å»ºï¼ˆdebug buildï¼‰

æ‰§è¡Œï¼š

```sh
cargo run
```

å³å¯è¿è¡Œåˆšåˆš build è¾“å‡ºçš„äº§ç‰©ã€‚å¦‚æœä½ åœ¨ `cargo run` ä¹‹å‰æœªæ„å»ºæˆ–ä¿®æ”¹äº†ä»£ç ï¼Œ`cargo` ä¼šè‡ªåŠ¨å¸®ä½ å®Œæˆ re-build å¹¶æ‰§è¡Œä»£ç ã€‚

```sh
cargo check
```

è¿™ä¸ªå‘½ä»¤å¯ä»¥å¸®ä½ å®Œæˆä»£ç çš„é™æ€æ£€æŸ¥ä¸”ä¸è¾“å‡ºä»»ä½•æ–‡ä»¶ï¼Œç”±äºå®ƒä¸éœ€è¦å‡†å¤‡è¾“å‡ºæ„å»ºäº§ç‰©ï¼Œæ‰€ä»¥å®ƒæ¯” `cargo build` è¦å¿«å¾—å¤šã€‚

### å‘å¸ƒæ„å»º

ä¸è°ƒè¯•æ„å»ºä¸åŒï¼Œå¯ä»¥æ‰§è¡Œï¼š

```sh
cargo build --release
```

æ¥æ„å»ºä¸€ä¸ªç”¨äºç”Ÿäº§ç¯å¢ƒçš„äº§ç‰©ï¼Œè¿™ä¼šåœ¨ `target/release/` ä¸‹è¾“å‡ºäº§ç‰©è€Œä¸æ˜¯ `target/debug/` ä¸‹ã€‚

å‘å¸ƒæ„å»ºçš„äº§ç‰©å¾€å¾€æœ‰é’ˆå¯¹ç”Ÿäº§çš„æ›´å¤šä¼˜åŒ–ï¼ŒåŒæ—¶æ„å»ºéœ€è¦èŠ±è´¹çš„æ—¶é—´ä¹Ÿæ›´é•¿ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¦æœ‰è°ƒè¯•æ„å»ºä¸å‘å¸ƒæ„å»ºçš„åŒºåˆ†ï¼šè°ƒè¯•æ„å»ºç”¨äºå¼€å‘æ—¶æ›´å¿«çš„çœ‹åˆ°æœ€ç»ˆæ•ˆæœï¼Œéœ€è¦ç»å¸¸å¿«é€Ÿåœ°æ‰§è¡Œæ„å»ºï¼Œè€Œå‘å¸ƒæ„å»ºåˆ™æ˜¯ä¸ºäº†æœ€ç»ˆç”¨æˆ·ä½¿ç”¨æ—¶æ„å»ºçš„ã€‚

## Gussing Game

å†™ä¸€ä¸ªçŒœæ•°æ¸¸æˆï¼š

ä½¿ç”¨ `use` æ ‡è¯†ç¬¦æ¥ä»æ ‡å‡†åº“ä¸­å¼•å…¥ `io` åº“ï¼Œä¹‹åå°±å¯ä»¥åœ¨å½“å‰ä½œç”¨åŸŸä¸­é€šè¿‡ `io:stdin()` è¯»å–åˆ°ç”¨æˆ·è¾“å…¥ï¼š

```rs
use std::io;

fn main() {
    println!("Guess the number!");

    println!("Please input your guess.");

    let mut guess = String::new();

    io::stdin()
        .read_line(&mut guess)
        .expect("Failed to read line");

    println!("You guessed: {guess}");
}
```

æ‰§è¡Œ `cargo run` åæµ‹è¯•ä¸€ä¸‹ï¼š

```sh
Guess the number!
Please input your guess.
6
You guessed: 6
```

### ä½¿ç”¨å˜é‡ä¿å­˜æ•°æ®

åœ¨ Rust ä¸­ï¼Œä½¿ç”¨ `let` ä¸ `const` å£°æ˜çš„å˜é‡é»˜è®¤éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œé€šè¿‡ç»™ `let` å£°æ˜çš„å˜é‡åŠ ä¸Š `mut` æ ‡è®°ï¼Œæ¥è®© guess è¿™ä¸ªå˜é‡å¯å˜ï¼ˆmutatiableï¼‰

`::new` ä¸­çš„ `::` è¡¨æ˜ï¼š`new` æ˜¯ `String` ç±»å‹çš„ä¸€ä¸ªå…³è”å‡½æ•°ï¼Œåœ¨ä¸€äº›è¯­è¨€ä¸­å®ƒè¢«ç§°ä¹‹ä¸ºé™æ€æ–¹æ³•ï¼ˆstatic functionï¼‰

æ€»çš„æ¥è¯´ï¼Œ`let mut guess = String::new();` è¿™ä¸€è¡Œåˆ›å»ºäº†ä¸€ä¸ªå¯å˜å˜é‡ï¼Œå½“å‰å®ƒç»‘å®šåˆ°ä¸€ä¸ªæ–°çš„ `String` ç©ºå®ä¾‹ä¸Šã€‚

### è¯»å–ç”¨æˆ·è¾“å…¥

å¦‚æœåœ¨ç¨‹åºå¼€å¤´æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ `use` æ¥å¼•å…¥ `io` åº“ï¼Œåœ¨ä»£ç ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š

```rs
std::io::stdin()
```

æ¥åŠ¨æ€åœ°å¼•å…¥ `io` åº“ï¼Œé€šè¿‡ `read_line` æ¥ä»æ ‡å‡†è¾“å…¥å¥æŸ„è·å–ç”¨æˆ·è¾“å…¥ã€‚

å°† `&mut guess` ä¼ é€’ç»™ `read_line`ï¼Œå…¶ä¸­ `&` è¡¨æ˜ä¼ é€’çš„æ˜¯ä¸€ä¸ªå˜é‡çš„å¼•ç”¨ï¼ŒåŒæ—¶ç”±äºå˜é‡æ˜¯ä¸å¯å˜çš„ï¼Œ`&mut` è¡¨ç¤ºè¿™ä¸ªå¼•ç”¨å¯ä»¥ä¿®æ”¹ã€‚

### ä½¿ç”¨ Result ç±»å‹å¤„ç†æ½œåœ¨é”™è¯¯

å‰æ–‡ä¸­æˆ‘ä»¬è¯´ `read_line` ä¼šæŒç»­åœ°å°†ç”¨æˆ·è¾“å…¥é™„åŠ åˆ°ä¼ é€’ç»™å®ƒçš„å­—ç¬¦ä¸²ä¸­ï¼Œå®ƒä¹Ÿä¼šè¿”å›ä¸€ä¸ª `Result` ç±»å‹çš„å€¼ã€‚

`Result` ç±»å‹æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼ŒåŒ…å«ä¸¤ç§æˆå‘˜ç±»å‹ï¼š

- `Ok`: è¡¨ç¤ºæ“ä½œæˆåŠŸï¼Œå†…éƒ¨åŒ…å«æˆåŠŸæ—¶äº§ç”Ÿçš„å€¼ï¼›
- `Err`: è¡¨ç¤ºæ“ä½œå¤±è´¥ï¼ŒåŒ…å«å¤±è´¥çš„å‰å› åæœã€‚

è¿™äº› `Result` ç±»å‹çš„ä½œç”¨æ˜¯å¤„ç†é”™è¯¯ä¿¡æ¯ï¼Œ`Result` çš„å®ä¾‹å…·æœ‰ `expect` æ–¹æ³•ï¼Œå¦‚æœ `io:Result` å®ä¾‹çš„å€¼æ˜¯ `Err`ï¼Œ`expect` ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œå¹¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚

å¦‚æœ `read_line` è¿”å› `Err`ï¼Œåˆ™å¯èƒ½æ˜¯æ¥æºäºåº•å±‚æ“ä½œç³»ç»Ÿé”™è¯¯çš„ç»“æœã€‚å¦‚æœ `Result` å®ä¾‹çš„å€¼æ˜¯ `Ok`ï¼Œ`expect` ä¼šè·å– `Ok` ä¸­çš„å€¼å¹¶åŸæ ·è¿”å›ã€‚

åœ¨æ­¤ä¾‹å­ä¸­ï¼Œè¿™ä¸ªå€¼æ˜¯ç”¨æˆ·è¾“å…¥åˆ°æ ‡å‡†è¾“å…¥ä¸­çš„å­—èŠ‚æ•°ã€‚

### ä½¿ç”¨ println! å ä½ç¬¦æ‰“å°å€¼

ä¸‹é¢è¿™ä¸¤ç§ `println!` æ˜¯ç­‰ä»·çš„ï¼Œä»–ä»¬éƒ½å¯ä»¥å°†å˜é‡æ‰“å°åˆ°æŒ‡å®šä½ç½®ï¼š

```rs
println!("You guessed: {guess}");
println!("You guessed: {}", guess);
```

### ç”Ÿæˆä¸€ä¸ªéšæœºæ•°

åœ¨ Rust æ ‡å‡†åº“ä¸­ä¸åŒ…å«éšæœºæ•°åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ rand crateï¼š

```sh
cargo add rand
```

å®‰è£…åï¼Œæˆ‘ä»¬åˆ° Cargo.toml ä¸­å¯ä»¥çœ‹åˆ°ï¼š

```toml
[dependencies]
rand = "0.8.5"
```

è¿™é‡Œçš„ `"0.8.5"` å®é™…ä¸Šæ˜¯ `"^0.8.5"` çš„ç®€å†™ï¼Œå®ƒè¡¨ç¤ºè‡³å°‘æ˜¯ `0.8.5` ä½†å°äº `0.9.0` çš„ç‰ˆæœ¬ã€‚

å…·ä½“å¯ä»¥å‚çœ‹[è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemantic Versioningï¼‰](https://semver.org/)

Cargo é€šè¿‡ Cargo.lock æ–‡ä»¶æ¥ä¿è¯æ¯ä¸€æ¬¡æ„å»ºéƒ½æ˜¯å¯ä»¥è¢«é‡ç°çš„ï¼Œä»»ä½•äººåœ¨ä»»ä½•æ—¶å€™é‡æ–°æ„å»ºä»£ç éƒ½ä¼šäº§ç”Ÿç›¸åŒçš„ç»“æœï¼ŒCargo åªä¼šä½¿ç”¨ä½ æŒ‡å®šçš„ä¾èµ–ç‰ˆæœ¬ã€‚

> å¦‚æœ rand åº“ä¸‹å‘¨å‘å¸ƒäº† `0.8.6` ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬ä¸­ä¿®å¤äº†ä¸€ä¸ª BUG ä½†å­˜åœ¨ç ´åæ€§å˜æ›´ï¼Œå¦‚æœä½ æ²¡æœ‰æ˜¾å¼åœ°åœ¨ Cargo.toml ä¸­å‡çº§ rand åº“ï¼Œé‚£ Cargo ä¼šæŒ‰ç…§ä¸Šä¸€æ¬¡æ„å»ºæˆåŠŸæ—¶ç”Ÿæˆçš„ Cargo.lock è®°å½•çš„ç¬¬ä¸‰æ–¹åº“ç‰ˆæœ¬æ¥æ„å»ºã€‚

å¦‚æœä½ ç¡®å®è¦å‡çº§ crateï¼Œå¯ä»¥ä½¿ç”¨ï¼š

```sh
cargo update
```

æ¥å¿½ç•¥ Cargo.lock æ–‡ä»¶ï¼Œå¹¶è®¡ç®—æ‰€æœ‰ç¬¦åˆ Cargo.toml å£°æ˜çš„æœ€æ–°ç‰ˆæœ¬ã€‚

å®‰è£…å®Œäº† rand crateï¼Œæˆ‘ä»¬ä¸‹é¢æ¥ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼š

```rs
use std::io;
use rand::Rng;

fn main() {
    println!("Guess the number!");

    let secret_number = rand::thread_rng().gen_range(1..=100);

    println!("The secret number is: {secret_number}");

    println!("Please input your guess.");

    let mut guess = String::new();

    io::stdin()
        .read_line(&mut guess)
        .expect("Failed to read line");

    println!("You guessed: {guess}");
}
```

`use rand:Rng;` å…¶ä¸­ï¼Œ`Rng` æ˜¯ä¸€ä¸ª traitï¼Œå®ƒå®šä¹‰äº†éšæœºæ•°ç”Ÿæˆå™¨å®ç°çš„æ–¹æ³•çš„è¯ï¼Œæ­¤ trait å¿…é¡»åœ¨ä½œç”¨åŸŸä¸­ã€‚

æˆ‘ä»¬è°ƒç”¨ `rand::thread_rng` å‡½æ•°æä¾›å®é™…ä½¿ç”¨çš„**éšæœºæ•°ç”Ÿæˆå™¨**ï¼šå®ƒä½äºå½“å‰æ‰§è¡Œçº¿ç¨‹çš„æœ¬åœ°ç¯å¢ƒä¸­ï¼Œä»æ“ä½œç³»ç»Ÿè·å– seedã€‚

éšåè°ƒç”¨éšæœºæ•°ç”Ÿæˆå™¨çš„ `gen_range` æ–¹æ³•ï¼Œå®ƒç”± `Rng` trait å®šä¹‰ï¼Œè·å–ä¸€ä¸ªèŒƒå›´è¡¨è¾¾å¼ï¼ˆRange expressionï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªåœ¨æ­¤èŒƒå›´ä¹‹é—´çš„éšæœºæ•°ã€‚

èŒƒå›´è¡¨è¾¾å¼ä½¿ç”¨ `start..=end` è¿™æ ·çš„å½¢å¼ï¼Œå¦‚ `1..=100` å°±ä»£è¡¨ 1 åˆ° 100 ä¹‹é—´ã€‚

::: info
ä½ ä¸å¯èƒ½å‡­ç©ºçŸ¥é“åº”å½“ use å“ªä¸ª traitï¼Œä»¥åŠåº”å½“ä» crate ä¸­è°ƒç”¨å“ªä¸ªæ–¹æ³•ï¼Œå› æ­¤æ¯ä¸ª crate éƒ½æœ‰è¯´æ˜æ–‡æ¡£ã€‚
é€šè¿‡è°ƒç”¨ `cargo doc --open` æ¥æ„å»ºæ‰€æœ‰æœ¬åœ°ä¾èµ–æä¾›çš„æ–‡æ¡£å¹¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ã€‚
:::

### å¯¹æ¯”ä¸¤ä¸ªæ•°å­—

```rs
// æ­¤ä»£ç ä¸å¯è¿è¡Œ
use rand::Rng;
use std::cmp::Ordering;
use std::io;

fn main() {
    // --snip--

    println!("You guessed: {guess}");

    match guess.cmp(&secret_number) {
        Ordering::Less => println!("Too small!"),
        Ordering::Greater => println!("Too big!"),
        Ordering::Equal => println!("You win!"),
    }
}
```

æˆ‘ä»¬å¼•å…¥ `std::cmp::Ordering` åˆ°ä½œç”¨åŸŸä¸­ã€‚`Ordering` ä¹Ÿæ˜¯ä¸€ä¸ªæšä¸¾ï¼Œå…¶æˆå‘˜åŒ…å« `Less`ã€`Greater` å’Œ `Equal`ï¼Œè¿™æ˜¯åœ¨ä¸¤ä¸ªå€¼è¿›è¡Œæ¯”è¾ƒæ—¶å¯èƒ½å‡ºç°çš„ä¸‰ç§ç»“æœã€‚

`cmp` æ–¹æ³•ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼ï¼Œå¹¶ä¸”**å¯ä»¥åœ¨ä»»ä½•å¯æ¯”è¾ƒçš„å€¼ä¸Šè°ƒç”¨**ã€‚å®ƒè·å–ä¸€ä¸ªè¢«æ¯”è¾ƒå€¼çš„å¼•ç”¨ï¼šå°† `guess` ä¸ `secret_number` ä½œæ¯”è¾ƒã€‚ç„¶åè¿”å›ä¸€ä¸ªé€šè¿‡ `use` å¼•å…¥ä½œç”¨åŸŸçš„ `Ordering` æšä¸¾çš„æˆå‘˜ã€‚

ä½¿ç”¨ `match` è¡¨è¾¾å¼ï¼Œæ ¹æ®å¯¹ `guess` å’Œ `secret_number` è°ƒç”¨ `cmp` è¿”å›çš„ `Ordering` æˆå‘˜ï¼Œæ¥å†³å®šä¸‹ä¸€æ­¥åº”è¯¥è¦åšä»€ä¹ˆã€‚

`match` è¡¨è¾¾å¼ç”±ä¼—å¤šçš„åˆ†æ”¯ï¼ˆarmsï¼‰æ„æˆï¼Œæ¯ä¸ªåˆ†æ”¯éƒ½åŒ…å«ä¸€ä¸ª pattern ä»¥åŠ pattern è¢«åŒ¹é…æ—¶è¦æ‰§è¡Œçš„ä»£ç ã€‚

å°è¯•æ‰§è¡Œæ­¤ä»£ç ï¼Œç¼–è¯‘å™¨ä¼šæŠ›å‡ºé”™è¯¯ï¼šä¸åŒ¹é…çš„ç±»å‹ï¼ˆmismatched typesï¼‰ã€‚Rust æœ‰ä¸€ä¸ªé™æ€å¼ºç±»å‹ç³»ç»Ÿï¼ŒåŒæ—¶ä¹Ÿæœ‰ç±»å‹æ¨æ–­ã€‚

å½“æˆ‘ä»¬å†™å‡º `let guess = String::new();` æ—¶ï¼ŒRust ä¼šå¸®æˆ‘ä»¬æ¨æ–­å‡º `guess` å˜é‡åº”å½“æ˜¯ `String` ç±»å‹ã€‚

è€Œ `secret_number` æ˜¯ 1 - 100 ä¹‹é—´çš„æ•°å­—ç±»å‹ï¼Œè€Œç¬¦åˆè¿™ä¸ªè¦æ±‚ï¼ˆ1~100ä¹‹é—´ï¼‰çš„æ•°å­—ï¼Œåœ¨ Rust ä¸­æœ‰ä¸‹é¢å‡ ç§ï¼š

- `i32` 32ä½æ•°å­—ï¼›
- `u32` 32ä½æ— ç¬¦å·æ•°å­—ï¼›
- `i64` 64ä½æ•°å­—
- ç­‰ç­‰ ...

Rust é»˜è®¤ä½¿ç”¨ `i32`ï¼Œæ‰€ä»¥ Rust é»˜è®¤ä¸º `secret_number` æ¨æ–­å‡ºçš„ç±»å‹æ˜¯ `i32`ï¼Œå¯¼è‡´äº†å­—ç¬¦ä¸²ä¸æ•°å­—ä½œå¯¹æ¯”çš„æƒ…å†µã€‚

è¦å°† `String` è½¬åŒ–ä¸ºæ•°å­—ç±»å‹æ‰èƒ½ä¸ `secret_number` ä½œæ¯”è¾ƒï¼š

```rs
let guess: u32 = guess.trim().parse().expect("Please type a number!");
```

ä¸Šé¢çš„ä»£ç å°†é‡æ–°å£°æ˜ `guess` å˜é‡ï¼Œè¿™ä¸ªç‰¹æ€§å«éšè—ï¼ˆShadowingï¼‰ï¼Œé€šè¿‡ `guess.trim()` å»é™¤å­—ç¬¦ä¸²å¤´å°¾çš„ç©ºç™½å­—ç¬¦ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ 5 å¹¶æŒ‰ä¸‹ç©ºæ ¼åï¼Œåœ¨ Unix ç³»ç»Ÿä¸­ `guess` çš„å€¼ä¸º `5\n`ï¼Œåœ¨ Windows ç³»ç»Ÿä¸­ `guess` çš„å€¼ä¸º `5\r\n`ï¼‰

`guess.parse()` æ–¹æ³•ä¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå…¶ä»–ç±»å‹ï¼Œé€šè¿‡ç»™ `guess` æ˜¾å¼æŒ‡å®šç±»å‹æ¥å‘Šè¯‰ `guess` æ–¹æ³•è½¬åŒ–çš„ç›®æ ‡ç±»å‹ï¼Œè¿™é‡Œçš„ç›®æ ‡ç±»å‹æ˜¯ `u32`ã€‚

åŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢å­—ç¬¦ä¸²ä¸­åŒ…å«ç‰¹æ®Šå­—ç¬¦ç­‰åŸå› å¯¼è‡´ `parse` æ‰§è¡Œå¤±è´¥ï¼Œè¿™é‡Œç”¨ `expect` æ¥å¯¹è½¬åŒ–æ˜¯å¦æˆåŠŸè¿›è¡Œæç¤ºï¼š

- å¦‚æœ `parse` ä¸èƒ½ä»å­—ç¬¦ä¸²ç”Ÿæˆä¸€ä¸ªæ•°å­—ï¼Œè¿”å›ä¸€ä¸ª `Result` çš„ `Err` æˆå‘˜æ—¶ï¼Œ`expect` æ–¹æ³•ä¼šä½¿ç¨‹åºç»“æŸå¹¶æ‰“å°é™„åŠ çš„ä¿¡æ¯ã€‚
- å¦‚æœ `parse` æˆåŠŸæ‰§è¡Œï¼Œé‚£ä¹ˆå®ƒä¼šè¿”å› `Result` çš„ `Ok` æˆå‘˜ï¼Œç„¶å `expect` ä¼šè¿”å› `Ok` å€¼ä¸­çš„æ•°å­—ã€‚

### ä½¿ç”¨å¾ªç¯æ¥å…è®¸å¤šæ¬¡çŒœæµ‹

å¯ä»¥ä½¿ç”¨ `loop` å…³é”®å­—æ¥åˆ›å»ºä¸€ä¸ªæ— é™å¾ªç¯ï¼Œç»™ç”¨æˆ·æ›´å¤šæœºä¼šæ¥çŒœæ•°ã€‚

```rs
    println!("The secret number is: {secret_number}");

    loop {
        println!("Please input your guess.");

        // --snip--

        match guess.cmp(&secret_number) {
            Ordering::Less => println!("Too small!"),
            Ordering::Greater => println!("Too big!"),
            Ordering::Equal => {
                println!("You win!");
                break;
            },
        }
    }
```

å½“ç”¨æˆ·æˆåŠŸçŒœå¯¹åï¼Œä¼šæ‰§è¡Œ `break;` é€€å‡ºç¨‹åºã€‚

### å¿½ç•¥éæ•°å­—çš„çŒœæµ‹å¹¶ç»§ç»­æ¸¸æˆ

ç›®å‰çš„ä»£ç å¦‚æœç”¨æˆ·è¾“å…¥äº†éæ•°å­—ï¼Œä¼šå¯¼è‡´ `parse` å¤±è´¥ï¼Œè¿›è€Œå¯¼è‡´ç¨‹åºé€€å‡ºï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ”¹å†™è¿™éƒ¨åˆ†çš„é€»è¾‘ï¼Œå°† `expect` è°ƒç”¨ æ”¹ä¸º `match`ï¼š

```rs
        // --snip--

        io::stdin()
            .read_line(&mut guess)
            .expect("Failed to read line");

        let guess: u32 = match guess.trim().parse() {
            Ok(num) => num,
            Err(_) => continue,
        };

        println!("You guessed: {guess}");

        // --snip--
```

è¿™æ ·å½“é‡åˆ°é”™è¯¯æ—¶ç¨‹åºä¸å†å´©æºƒï¼Œè€Œæ˜¯è¿›å…¥åˆ° `match` çš„é”™è¯¯åˆ†æ”¯ä¸­å¤„ç†é”™è¯¯ï¼šè°ƒç”¨ `continue;` ç»§ç»­å¾ªç¯ã€‚

### æ€»ç»“

è¿™ä¸€ç« é‡Œæˆ‘ä»¬å­¦ä¹ äº†ä½¿ç”¨ `let` å£°æ˜å˜é‡ã€å˜é‡éšè—ã€ç±»å‹è½¬åŒ–ã€`match` å¤„ç†å¤šåˆ†æ”¯ä»»åŠ¡ã€`loop` å¾ªç¯ã€‚

è¿˜å­¦ä¹ äº†å¤–éƒ¨ crate çš„ä½¿ç”¨ã€å¦‚ä½•æŒ‡å®šæ•°æ®ç±»å‹ç­‰

## å¸¸è§ç¼–ç¨‹æ¦‚å¿µ

### å˜é‡å’Œå¯å˜æ€§

å˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼ˆImmutableï¼‰ï¼Œè¿™æ˜¯ Rust æä¾›çš„ä¼—å¤šç‰¹æ€§ä¹‹ä¸€ï¼š

ä¸‹é¢çš„ä»£ç ç”±äºä¿®æ”¹äº† `x` å¯¼è‡´ç¼–è¯‘ä¸é€šè¿‡ï¼š

```rs
fn main() {
    let x = 5;
    println!("x is {}", x);
    x = 6;
    println!("x is {}", x);
}
```

ç¼–è¯‘å™¨æŠ›å‡ºçš„é”™è¯¯ä¿¡æ¯ï¼šcannot assign twice to immutable variable `x`

è¦è®© `x` å˜å¾—å¯å˜ï¼Œå¯ä»¥åœ¨å£°æ˜ `let` åæ·»åŠ  `mut`ï¼š

```rs
let mut x = 5;
```

è¿™æ ·å°±å¯ä»¥ä¿®æ”¹ `x` çš„å€¼äº†ã€‚

é™¤äº† `let`ï¼Œè¿˜å¯ä»¥é€šè¿‡ `const` å£°æ˜ä¸€ä¸ªå¸¸é‡ï¼š

- å¸¸é‡æ€»æ˜¯ä¸å¯å˜ï¼Œä¸”ä¸å…è®¸å¯¹å¸¸é‡ä½¿ç”¨ `mut`
- å¿…é¡»åœ¨å£°æ˜æ—¶æ³¨æ˜å€¼çš„ç±»å‹
- å¸¸é‡åªèƒ½è¢«è®¾ç½®ä¸ºå¸¸é‡è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯ä»»ä½•åªèƒ½åœ¨è¿è¡Œæ—¶è®¡ç®—å‡ºçš„å€¼

```rs
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;
```

è¿™é‡Œçš„ `60 * 60 * 3` ä¼šåœ¨ç¼–è¯‘å™¨ç¼–è¯‘æ—¶æ‰§è¡Œè¿ç®—ï¼Œè¿™ä½¿æˆ‘ä»¬å¯ä»¥é€‰æ‹©æ›´å®¹æ˜“ç†è§£å’ŒéªŒè¯çš„æ–¹å¼æ¥å†™å‡ºè¿™ä¸ªå€¼ï¼Œè€Œä¸æ˜¯ç›´æ¥å°†å¸¸é‡è®¾ç½®ä¸º `10,800`ã€‚

åœ¨å‰æ–‡ä¸­æˆ‘ä»¬ä»‹ç»äº†å˜é‡éšè—ï¼Œåå£°æ˜çš„åŒåå˜é‡å°†ä¼šå±è”½æ‰ä¹‹å‰å£°æ˜çš„å˜é‡ï¼Œç›´åˆ°æ–°çš„å˜é‡ä¹Ÿè¢«éšè—æˆ–ä½œç”¨åŸŸç»“æŸï¼š

```rs
fn main() {
    let x = 5; // 5

    let x = x + 1; // 6

    {
        let x = x * 2;
        println!("x is {}", x); //  12
    }

    println!("x is {}", x); // 6
}
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéšè—ä¸å°†å˜é‡æ ‡è®°ä¸º `mut` æ˜¯æœ‰åŒºåˆ«çš„ï¼Œå½“å¯¹å˜é‡è¿›è¡Œé‡æ–°èµ‹å€¼æ—¶ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨ `mut` é‚£ä¹ˆä¼šå¯¼è‡´ç¼–è¯‘æ—¶é”™è¯¯ã€‚é€šè¿‡å˜é‡éšè—ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ–°çš„å˜é‡è¿›è¡Œä¸€äº›è®¡ç®—ï¼Œä½†è®¡ç®—å®Œä¹‹åå˜é‡ä¾ç„¶æ˜¯ä¸å¯å˜çš„ã€‚

`mut` ä¸éšè—çš„å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼šå½“å†æ¬¡ä½¿ç”¨ `let` å£°æ˜å˜é‡æ—¶ï¼Œéšè—å®é™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜å€¼çš„ç±»å‹ï¼Œåªä¸è¿‡å¤ç”¨è¿™ä¸ªåå­—ï¼š

å¦‚æœæ²¡æœ‰å˜é‡éšè—ï¼Œä»£ç å¯èƒ½ä¼šåƒè¿™æ ·ï¼š

```rs
let spaces_str = "    ";
let spaces_num = spaces_str.len();
```

åˆ©ç”¨å˜é‡éšè—ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å¤ç”¨ç›¸åŒå˜é‡åï¼š

```rs
let spaces = "    "; // æ–‡æœ¬ä¹‹é—´çš„ç©ºæ ¼æ•°é‡
let spaces = spaces.len(); // å¤šå°‘ä¸ªç©ºæ ¼
```

ç„¶è€Œï¼Œå¦‚æœä½¿ç”¨ `mut`ï¼Œä»–ä¸å…è®¸ä¿®æ”¹å˜é‡çš„ç±»å‹ï¼š

```rs
let spaces = "    ";
spaces = spaces.len(); // é”™è¯¯ï¼šä¸èƒ½æ”¹å˜å˜é‡çš„ç±»å‹
```

### æ•°æ®ç±»å‹

åœ¨ Rust ä¸­ï¼Œæ¯ä¸€ä¸ªå€¼éƒ½å±äºæŸä¸€ç§æ•°æ®ç±»å‹ï¼ˆdata typeï¼‰ï¼Œè¿™å‘Šè¯‰ Rust å®ƒè¢«æŒ‡å®šä¸ºä½•ç§æ•°æ®ã€‚

Rust æ˜¯é™æ€ç±»å‹ï¼ˆstatically typedï¼‰è¯­è¨€ç¼–è¯‘æ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ï¼Œå½“å¤šç§ç±»å‹å‡æœ‰å¯èƒ½æ—¶ï¼Œä¾‹å¦‚ä½¿ç”¨ `parse` å°† `String` è½¬æ¢ä¸ºæ•°å­—æ—¶ï¼Œå¿…é¡»å¢åŠ ç±»å‹æ³¨è§£ï¼Œåƒè¿™æ ·ï¼š

```rs
let guess: u32 = "42".parse().expect("Not a number!")
```

åœ¨ Rust ä¸­æœ‰ä¸¤ç§æ•°æ®ç±»å‹å­é›†ï¼šæ ‡é‡å’Œå¤åˆ

#### æ ‡é‡ç±»å‹ï¼ˆscalarï¼‰

##### æ•´å‹

æ•´å‹æ˜¯ä¸€ä¸ªæ²¡æœ‰å°æ•°éƒ¨åˆ†çš„æ•°å­—ï¼Œä¾‹å¦‚ `u32` ä»£è¡¨ä¸€ä¸ªå æ® 32 bit çš„æ— ç¬¦å·æ•´æ•°ã€‚å…¶ä¸­**æœ‰ç¬¦å·**å’Œ**æ— ç¬¦å·**ä»£è¡¨æ•°å­—èƒ½å¦ä¸ºè´Ÿå€¼ã€‚

| é•¿åº¦    | æœ‰ç¬¦å· | æ— ç¬¦å· |
|-------|------|------|
| 8-bit  | i8   | u8   |
| 16-bit | i16  | u16  |
| 32-bit | i32  | u32  |
| 64-bit | i64  | u64  |
| 128-bit| i128 | u128 |
| arch   | isize| usize|

æœ‰ç¬¦å·çš„æ•´å‹å¯ä»¥å­˜å‚¨ä» $-(2^{n-1})$ åˆ° $2^{n-1}-1$ åœ¨å†…çš„æ•°å­—ï¼Œè¿™é‡Œçš„ $n$ ä»£è¡¨ä½æ•°ã€‚

ä¾‹å¦‚ `i8` å¯ä»¥å­˜å‚¨ $-(2^7)$ åˆ° $2^7-1$ åœ¨å†…çš„æ•°å­—ï¼Œä¹Ÿå°±æ˜¯ä» -128 åˆ° 127ã€‚

æ— ç¬¦å·çš„æ•´å‹å¯ä»¥å­˜å‚¨ä» $0$ åˆ° $2^n-1$çš„æ•°å­—ã€‚

æ‰€ä»¥ `u8` å¯ä»¥å­˜å‚¨ $0$ åˆ° $2^8-1$ çš„æ•°å­—ï¼Œä¹Ÿå°±æ˜¯ 0 åˆ° 255ã€‚

å¦å¤–ï¼Œ`isize` ä¸ `usize` ç±»å‹ä¾èµ–è¿è¡Œç¨‹åºçš„è®¡ç®—æœºæ¶æ„ï¼šåœ¨ 64 ä½æ¶æ„ä¸Šï¼Œå®ƒä»¬æ˜¯ 64 ä½çš„ï¼Œåœ¨ 32 ä½æ¶æ„ä¸Šï¼Œå®ƒä»¬æ˜¯ 32 ä½çš„ã€‚åˆ†åˆ«ç­‰ä»·äº `i64` `i32` ä¸ `u64` å’Œ `u32`ã€‚

é™¤äº†é€šè¿‡ç±»å‹æŒ‡å®šå˜é‡çš„æ•´å‹ç±»å‹ï¼Œè¿˜å¯ä»¥ä»¥åç¼€å½¢å¼ä½¿ç”¨ç±»å‹ï¼Œä¾‹å¦‚ `let x = 57u8;`ã€‚è¿˜å¯ä»¥é€šè¿‡æ•°å­—å­—é¢å€¼æ¥æŒ‡å®šç±»å‹ï¼š

`1000` ä¸ `1_000` ç­‰ä»·ï¼Œä½†åè€…æ›´æ˜“è¯»ã€‚

| æ•°å­—å­—é¢å€¼                | ä¾‹å­         |
|------------------------|------------|
| Decimal (åè¿›åˆ¶)         | 98_222     |
| Hex (åå…­è¿›åˆ¶)           | 0xff       |
| Octal (å…«è¿›åˆ¶)           | 0o77       |
| Binary (äºŒè¿›åˆ¶)          | 0b1111_0000 |
| Byte (å•å­—èŠ‚å­—ç¬¦)(ä»…é™äºu8) | b'A'        |

##### æµ®ç‚¹å‹

åœ¨ Rust ä¸­æœ‰ä¸¤ä¸ªåŸç”Ÿæµ®ç‚¹æ•°ç±»å‹ï¼š

- `f32` å•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œå  32 ä½
- `f64` åŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œå  64 ä½ï¼Œç°ä»£ CPU ä¸­ï¼Œå®ƒä¸ `f32` é€Ÿåº¦å‡ ä¹ä¸€æ ·ï¼Œä¸è¿‡ç²¾åº¦æ›´é«˜

æµ®ç‚¹æ•°éƒ½æ˜¯æœ‰ç¬¦å·çš„ã€‚

```rs
fn main() {
    let x = 2.0; // f64
    let y: f32 = 3.0; // f32
}
```

Rust ä¸­çš„æ‰€æœ‰æ•°å­—ç±»å‹éƒ½æ”¯æŒåŸºæœ¬æ•°å­¦è¿ç®—ï¼šåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•ã€é™¤æ³•å’Œå–ä½™ã€‚æ•´æ•°é™¤æ³•ä¼šå‘é›¶èˆå…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ï¼š

```rs
fn main() {
    // addition
    let sum = 5 + 10;

    // subtraction
    let difference = 95.5 - 4.3;

    // multiplication
    let product = 4 * 30;

    // division
    let quotient = 56.7 / 32.2;
    let truncated = -5 / 3; // ç»“æœä¸º -1

    // remainder
    let remainder = 43 % 5;
}
```

##### å¸ƒå°”å‹

```rs
let t = true;
let f: bool = false;
```

##### å­—ç¬¦ç±»å‹

Rust çš„ `char` ç±»å‹æ˜¯è¯­è¨€æœ€åŸç”Ÿçš„å­—æ¯ç±»å‹ï¼Œå¤§å°ä¸ºå››ä¸ªå­—èŠ‚ï¼š

```rs
fn main() {
    let c = 'z';
    let z: char = 'â„¤'; // æ˜¾å¼ç±»å‹å£°æ˜
    let heart_eye_cat = 'ğŸ˜»';
}
```

#### å¤åˆç±»å‹ï¼ˆcompoundï¼‰

å¤åˆç±»å‹ï¼ˆCompound typesï¼‰å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚Rust æœ‰ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆtupleï¼‰å’Œæ•°ç»„ï¼ˆarrayï¼‰ã€‚

##### å…ƒç»„ç±»å‹

å…ƒç»„æ˜¯ä¸€ä¸ªå°†å¤šä¸ªå…¶ä»–ç±»å‹çš„å€¼ç»„åˆè¿›ä¸€ä¸ªå¤åˆç±»å‹çš„ä¸»è¦æ–¹å¼ã€‚å…ƒç»„é•¿åº¦å›ºå®šï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°ã€‚

```rs
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
```

å¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…ï¼ˆpattern matchingï¼‰æ¥è§£æ„ï¼ˆdestructureï¼‰å…ƒç»„å€¼ï¼š

```rs
fn main() {
    let tup = (500, 6.4, 1);

    let (x, y, z) = tup;

    println!("{}", y); // 6.4
}
```

ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ `.` è·Ÿéšå€¼çš„ç´¢å¼•æ¥è®¿é—®å…ƒç»„ä¸­çš„å…ƒç´ ï¼š

```rs
fn main() {
    let tup = (500, 6.4, 1);
    
    let x = tup.0;
    let y = tup.1;
    let z = tup.2;

    println!("{}", x); // 500
}
```

ä¸å¸¦ä»»ä½•å€¼çš„å…ƒç»„æœ‰ä¸ªç‰¹æ®Šçš„åç§°ï¼Œå«åš å•å…ƒï¼ˆunitï¼‰ å…ƒç»„ã€‚è¿™ç§å€¼ä»¥åŠå¯¹åº”çš„ç±»å‹éƒ½å†™ä½œ `()`ï¼Œè¡¨ç¤º**ç©ºå€¼æˆ–ç©ºçš„è¿”å›ç±»å‹**ã€‚å¦‚æœè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å…¶ä»–å€¼ï¼Œåˆ™ä¼šéšå¼è¿”å›å•å…ƒå€¼ã€‚

##### æ•°ç»„ç±»å‹

ä¸å…ƒç»„ä¸åŒï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒã€‚

**Rust ä¸­çš„æ•°ç»„é•¿åº¦æ˜¯å›ºå®šçš„ã€‚**

```rs
fn main() {
    let a = [1, 2, 3, 4, 5];
}
```

å½“ä½ æƒ³è¦åœ¨æ ˆï¼ˆstackï¼‰è€Œä¸æ˜¯åœ¨å †ï¼ˆheapï¼‰ä¸Šä¸ºæ•°æ®åˆ†é…ç©ºé—´ï¼ˆç¬¬å››ç« å°†è®¨è®ºæ ˆä¸å †çš„æ›´å¤šå†…å®¹ï¼‰ï¼Œæˆ–è€…æ˜¯æƒ³è¦ç¡®ä¿æ€»æ˜¯æœ‰å›ºå®šæ•°é‡çš„å…ƒç´ æ—¶ï¼Œæ•°ç»„éå¸¸æœ‰ç”¨ã€‚

ä½†æ˜¯æ•°ç»„å¹¶ä¸å¦‚ `vector` ç±»å‹çµæ´»ã€‚

`vector` ç±»å‹æ˜¯æ ‡å‡†åº“æä¾›çš„ä¸€ä¸ª å…è®¸ å¢é•¿å’Œç¼©å°é•¿åº¦çš„ç±»ä¼¼æ•°ç»„çš„é›†åˆç±»å‹ã€‚å½“ä¸ç¡®å®šæ˜¯åº”è¯¥ä½¿ç”¨æ•°ç»„è¿˜æ˜¯ vector çš„æ—¶å€™ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½åº”è¯¥ä½¿ç”¨ `vector`ã€‚

ç„¶è€Œï¼Œå½“ä½ **ç¡®å®šå…ƒç´ ä¸ªæ•°ä¸ä¼šæ”¹å˜æ—¶ï¼Œæ•°ç»„ä¼šæ›´æœ‰ç”¨**ã€‚

ä¾‹å¦‚ï¼Œå½“ä½ åœ¨ä¸€ä¸ªç¨‹åºä¸­ä½¿ç”¨æœˆä»½åå­—æ—¶ï¼Œä½ æ›´åº”è¶‹å‘äºä½¿ç”¨æ•°ç»„è€Œä¸æ˜¯ `vector`ï¼Œå› ä¸ºä½ ç¡®å®šåªä¼šæœ‰ 12 ä¸ªå…ƒç´ ã€‚

```rs
let months = ["January", "February", "March", "April", "May", "June", "July",
              "August", "September", "October", "November", "December"];
```

å£°æ˜æ•°ç»„æ—¶ï¼Œå¯ä»¥åƒè¿™æ ·ç¼–å†™æ•°ç»„çš„ç±»å‹ï¼Œæ—¢èƒ½çº¦æŸæ•°ç»„ä¸­å…ƒç´ çš„ç±»å‹ï¼Œè¿˜èƒ½é™åˆ¶æ•°ç»„çš„é•¿åº¦ï¼š

```rs
let a: [i32; 5] = [1, 2, 3, 4, 5];
```

è¿™é‡Œçš„ `i32` ä»£è¡¨æ¯ä¸ªå…ƒç´ çš„ç±»å‹ï¼Œåˆ†å·ä¹‹åçš„ `5` ä»£è¡¨æ•°ç»„çš„é•¿åº¦ä¸º 5ï¼ŒåŒ…å«äº”ä¸ªå…ƒç´ ã€‚

è¿˜å¯ä»¥åœ¨ç±»å‹å£°æ˜ä¸­æŒ‡å®šåˆå§‹å€¼ï¼š

```rs
let b: [3, 5];
```

è¿™æ ·å˜é‡ `b` å°±æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 5ï¼Œåˆå§‹å€¼å…¨ä¸º 3 çš„æ•°ç»„ã€‚

æ•°ç»„æ˜¯å¯ä»¥åœ¨æ ˆ (stack) ä¸Šåˆ†é…çš„å·²çŸ¥å›ºå®šå¤§å°çš„å•ä¸ªå†…å­˜å—ã€‚å¯ä»¥ä½¿ç”¨ç´¢å¼•æ¥è®¿é—®æ•°ç»„çš„å…ƒç´ ï¼Œåƒè¿™æ ·ï¼š

```rs
let c = [1, 2, 3, 4, 5];

let x = c[0]; // 1
let y = c[1]; // 2
```

é€šè¿‡ç´¢å¼•ä»æ•°ç»„ä¸­å–å€¼çš„æ“ä½œå¦‚æœæ˜¯åœ¨è¿è¡Œæ—¶è¿›è¡Œçš„ï¼Œé‚£ä¹ˆä»£ç å¯ä»¥é¡ºåˆ©é€šè¿‡ç¼–è¯‘ï¼Œä½†åœ¨è¿è¡Œæ—¶ä¼šå‡ºé”™ï¼š

ä¸‹é¢è¿™æ®µä»£ç å¯ä»¥æ­£å¸¸é€šè¿‡ç¼–è¯‘ï¼Œå½“ä½ è¾“å…¥ 0 1 2 3 4 è®¿é—®æ•°ç»„æ—¶å·¥ä½œæ­£å¸¸ï¼Œä½†ä¸€æ—¦è¾“å…¥äº†è¶…è¿‡æ•°ç»„é•¿åº¦çš„ç´¢å¼•å¦‚ 10ï¼Œå°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚

```rs
use std::io;

fn main() {
    let a = [1, 2, 3, 4, 5];

    println!("Please enter an array index.");

    let mut index = String::new();

    io::stdin()
        .read_line(&mut index)
        .expect("Failed to read line");

    let index: usize = index
        .trim()
        .parse()
        .expect("Index entered was not a number");

    let element = a[index];

    println!("The value of the element at index {index} is: {element}");
}
```

```sh
thread 'main' panicked at 'index out of bounds: the len is 5 but the index is 10', src/main.rs:19:19
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
```

### å‡½æ•°

- å¿…é¡»æ˜¾å¼æŒ‡å®šå‚æ•°çš„ç±»å‹
- é€šè¿‡ `->` æŒ‡å®šè¿”å›å€¼çš„ç±»å‹
- å‡½æ•°ç»“å°¾ä¸åŒ…å«åˆ†å·æ—¶ï¼Œéšå¼è¿”å›è¡¨è¾¾å¼

```rs
fn main() {
    print_labeled_measurement(188, 's');

    let f: i32 = five();
    println!("five: {}", f);
}

fn print_labeled_measurement(value: i32, unit_label: char) {
    println!("The measurement is: {value}{unit_label}");
}

fn five() -> i32 {
    // ç»“å°¾ä¸åŒ…å«åˆ†å· éšå¼è¿”å›è¡¨è¾¾å¼
    5
}
```

### æ§åˆ¶æµ

#### if-else & else-if

- å¯ä»¥çœç•¥ if ä¸æ¡ä»¶ä¹‹é—´çš„ç©ºæ ¼
- ä¸å…è®¸éšå¼è½¬æ¢

```rs
fn main() {
    let number = 3;

    if number < 5 {
        println!("Yes.");
    } else {
        println!("No.");
    }
}
```

```rs
// ä¸å…è®¸éšå¼è½¬æ¢ æ¡ä»¶è¡¨è¾¾å¼å¿…é¡»è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼
if number {
    println!("Yes.");
}

if number != 0 {
    println!("Yes.");
}
```

`if` å¯ä»¥è¿”å›ä¸€ä¸ªå€¼ï¼Œå› æ­¤å¯ä»¥åœ¨ `let` è¯­å¥ä¸­ä½¿ç”¨ `if`ï¼š

```rs
fn main() {
    let condition = true;
    // if ä¸ else åˆ†æ”¯çš„ç»“æœéƒ½ä¸º i32
    let number = if condition { 5 } else { 6 };

    println!("number: {}", number);
}
```

ç”±äºç±»å‹å¿…é¡»åœ¨ç¼–è¯‘æ—¶è¢«ç¡®å®šï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¯†åˆ«å‡ºä¸ç¬¦åˆè¿™ä¸€åŸåˆ™çš„ if-in-let å£°æ˜ï¼š

```rs
fn main() {
    // ç¼–è¯‘æŠ¥é”™ å› ä¸º if ä¸ else åˆ†æ”¯çš„ç»“æœç±»å‹ä¸åŒ
    let number = if condition { 5 } else { "six" }
}
```

#### å¾ªç¯

- `break;` ç”¨äºä¸­æ­¢å¾ªç¯
- `continue;` ç”¨äºè·³è¿‡å½“æ¬¡å¾ªç¯
- `break;` å¯ä»¥ä»å¾ªç¯è¿”å›è¡¨è¾¾å¼

```rs
fn main() {
    let mut count = 0;

    let result = loop {
        count += 1;

        if (count == 10) {
            break count * 2;
        }
    }

    println!("result: {}", result); // 20
}
```

å¾ªç¯æ ‡ç­¾ï¼šåœ¨å¤šä¸ªå¾ªç¯ä¹‹é—´æ¶ˆé™¤æ­§ä¹‰

å¦‚æœä½ å­˜åœ¨ä¸€ä¸ªåµŒå¥—çš„å¾ªç¯ï¼Œè€Œ `break;` ä¸ `continue;` åªä¼šåº”ç”¨äºæ­¤æ—¶æœ€å†…å±‚çš„å¾ªç¯ï¼Œå¯ä»¥é€šè¿‡å¾ªç¯æ ‡ç­¾æ¥è®©è¿™äº›å…³é”®å­—åº”ç”¨äºå·²æ ‡è®°çš„å¾ªç¯ï¼š

```rs
fn main() {
    let mut count = 0;
    'counting_up: loop {
        println!("count = {count}");
        let mut remaining = 10;

        loop {
            println!("remaining = {remaining}");
            if remaining == 9 {
                break;
            }
            if count == 2 {
                break 'counting_up;
            }
            remaining -= 1;
        }

        count += 1;
    }
    println!("End count = {count}");
}
```

ä¸Šé¢çš„ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ª `break;` è¯­å¥åªä¼šé€€å‡ºå†…å±‚å¾ªç¯ï¼Œè€Œ `break 'counting_up';` è¯­å¥å°†ç›´æ¥é€€å‡ºå¤–å±‚å¾ªç¯ã€‚

é™¤äº† `loop`ï¼ŒRust è¿˜æ”¯æŒé€šè¿‡ `while` æ¥æ§åˆ¶å¾ªç¯ï¼š

```rs
fn main() {
    let mut number = 3;

    while number != 0 {
        println!("{number}!");

        number -= 1;
    }

    println!("LIFTOFF!!!");
}
```

å½“æˆ‘ä»¬è¦å®ç°éå†é›†åˆä¸­çš„å…ƒç´ æ—¶ï¼Œç”¨ `for` ä¼šæ›´æ–¹ä¾¿ï¼š

```rs
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a {
        println!("value is {}", a);
    }
}
```

`for` äº¦å¯ç”¨äºè®¡æ—¶ï¼š

è¿™æ®µä»£ç ä¸­ç”¨åˆ°äº† `.rev()` æ–¹æ³•æ¥å°† range åè½¬

```rs
fn main() {
    for number in (1..4).rev() {
        println!("{number}!");
    }
    println!("LIFTOFF!!!");
}
```

## æ‰€æœ‰æƒ

### ä»€ä¹ˆæ˜¯æ‰€æœ‰æƒ

### å¼•ç”¨ä¸å€Ÿç”¨

### Slice ç±»å‹

## ç»“æ„ä½“

### ç»“æ„ä½“çš„å®šä¹‰ä¸åˆå§‹åŒ–

### ç¤ºä¾‹

### æ–¹æ³•è¯­æ³•

## æšä¸¾å’Œæ¨¡å¼åŒ¹é…

### æšä¸¾çš„å®šä¹‰

### match æ§åˆ¶æµç»“æ„

### if let ç®€æ´æ§åˆ¶æµ